<h1>Job selection</h1>

<h2>Selecting the Resource Manager (Job Launcher)</h2>
<i>Padb</i> supports many resource managers and should select
the appropriate one for your cluster, if you have more than
one resource manager installed or <i>padb</i> can't detect
the correct one use the <b>rmgr</b> <a href=#config>configuration option</a>.

<p>If no resource manager is found use <b>-O rmgr=local</b> and process
identifiers will be used instead of job ids.

<p>The <b>--list-rmgrs</b> option can be used to show a list of detected
resource managers and their active jobs.

<h2>Selecting the job(s) to target</h2>
<i>Padb</i> provides several ways for the user to select which jobs
to target depending on requirements.  All jobs detected by padb are
identified by a unique numeric "jobid", typically this maps directly
only a identifier provided by the underlying resource manager.
The default is to target jobs of the current user, this can be
over-ridden with the <b>--user</b> flag.

<h3>Showing list of current jobs</h3>
To show a list of currently running jobs for a given user use the
<b>--show-jobs</b> flag.

<h3>To target all jobs</h3>
To target all jobs currently running for a given user use the <b>--all</b> (<b>-a</b>) flag.


<h3>To target any jobs</h3>
To target "any" job currently running for a given user use the <b>--any</b> (<b>-A</b>) flag.
This differs from targeting all jobs as it will exit with an error if more
than one job is running.

<h3>To target a specific job</h3>
To target a specific job specify the jobid for the job on the command line,
after all other options.

<a name=full-report</a><h3>To target a specific job (Full report option)</h3>
If trying to diagnose a problem or gather information there is another
option, <b>--full-report=&lt;jobid&gt;</b>, this tells padb to target the job
specified and to report all information about the job it knows how to
collect.  This option is typically used when creating bug reports to
send to third parties or to inspect a job for anomalies.

<h2>Example</h2>
To show a stack trace for process ID 10
use <pre>padb -Ormgr=local --stack-trace 10</pre>

<hr>


<h1>Selecting ranks (Processes)</h1>
In modes where data for each process is reported separately it is possible
to restrict which ranks are queried, this is done via the <b>--rank</b> option.
Multiple ranks can be selected by specifying <b>--rank</b> multiple times
or passing a comma separated list.

<hr>

<h1>Selecting which mode to run in.</h1>
<i>Padb</i> can present an array of different information about your
select jobs and it can present it in a number of different ways.  With
the exception of Full Report only one mode can be selected, if you need
more information about the program run <i>padb</i> more than once.

<h2>Full Report</h2>
If you are just starting with <i>padb</i> or are creating an error
report for somebody else then the <b>--full-report=&lt;jobid&gt;</b> option is a good place
to start, this will complete a full diagnostic report for the job
iterating over the more common padb options.  For large jobs this can
generate a lot of output so redirecting to a file is recommended.

<h2>Stack Trace</h2>
The <b>--stack-trace</b> (<b>-x</b>) option will cause a stack trace to be given for
each selected rank.  The stack trace generated by this call is moderately
terse and gives one function call per line.  This option is best combined
with <b>--tree</b> (<b>-t</b>) to condense stack traces into a tree based format.

<h3>Stack Trace (Longer)</h3>
Fuller stack traces can be obtained by setting the <a href=#config>configuration options</a>
stack-shows-params=1 and stack-shows-locals=1.  This can help to narrow
down a problem however does not work well with tree based stack traces
so is recommended to be used with the <b>--rank</b> flag.

<h2>Message Queues</h2>
For MPI programs the MPI Message Queues can be shown on MPI stacks
which support it, use the <b>--message-queue</b> (<b>-q</b>) option to show the 
message queues.

<h2>Process info</h2>
To view information about individual processes in a job use the
<b>--proc-info</b> option, best combined with <b>--proc=format=&lt;format&gt;</b>,
for example <b>--proc-format=vp,pid,state,pcpu,vmsize,vmrss</b>

<hr>

<a name=config></a><h1>Configuration options</h1>
<i>padb</i> has a number of extended configuration options for tuning
it's behavior, these can be set in a number of ways.  All configuration
options are key/value pairs.
<ul>
<li>Command line</li>
Use the command-line option <b>--config-option &lt;key&gt;=&lt;value&gt;</b>.
<b>-O</b> can be substituted for <b>--config-option</b>.
<li>Environment</li>
Set the environment variable <b>PADB_&lt;KEY&gt;=&lt;value&gt;</b>.  All 
environment variables should be specified in upper case.
<li>Config file</li>
Config is also loaded from <b>/etc/padb.conf</b> and <b>~/.padbrc</b>.  Contact the
<a href=email.html>mailing lists</a> for help with these files.
</ul>
A list of configuration options along with their current values can be
obtained by specifying a key of help with or without a value, i.e. <b>padb -Ohelp</b>

<h2>Example</h2>
<pre>
ashley@alpha:~$ padb --show-jobs
Error, multiple resource managers detected, use -Ormgr=<resource manager>
orte slurm local-fd local
ashley@alpha:~$ padb --show-jobs --config-option rmgr=orte
59315
ashley@alpha:~$ export PADB_RMGR=orte
ashley@alpha:~$ padb --show-jobs
59315
ashley@alpha:~$ 
</pre>
